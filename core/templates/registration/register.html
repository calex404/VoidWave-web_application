{% extends "base.html" %}

{% block title %}Registrácia{% endblock %}

{% block background_loop %}{% endblock %}
{% block nav_bar %}{% endblock %}

{% block content %}
    <div class="reg-container">
        <div class="auth-card">
            <h2 class="auth-title">Registrácia</h2>

            <form method="post" id="register-form">
                {% csrf_token %}

                {% if form.errors %}
                    <div class="form-error-box">
                        <p style="margin: 0; font-weight: bold;">⚠️ Chyba v údajoch.</p>
                    </div>
                {% endif %}

                <div class="form-group">
                    <label>Meno:</label>
                    {{ form.username }}
                </div>

                <div class="form-group">
                    <label>Email:</label>
                    {{ form.email }}
                </div>

                <div class="form-group">
                    <label>Prezývka:</label>
                    {{ form.nickname }}
                </div>

                <div class="form-group">
                    <label>Popis: <span class="field-help" id="bio-limit">(max 100 slov)</span></label>
                    {{ form.bio }}
                </div>

                <div class="form-group">
                    <label>Heslo:</label>
                    {{ form.password1 }} 
                </div>

                <div class="form-group">
                    <label>Potvrdenie hesla:</label>
                    {{ form.password2 }}
                </div>

                <div class="login-checkbox-group">
                    <input type="checkbox" id="show-password-reg"> 
                    <label for="show-password-reg">Zobraziť heslá</label>
                </div>

                <button type="submit" class="btn-auth">Zaregistrovať sa</button>
            </form>
        </div>
    </div>
{% endblock content %}

{% block scripts %}
<script>
    document.addEventListener('DOMContentLoaded', function() {
        const bioArea = document.querySelector('textarea[name="bio"]');
        const wordHint = document.getElementById('bio-limit');

        if (bioArea) {
            const checkWords = function() {
                const text = bioArea.value.trim();
                const words = text.split(/\s+/).filter(w => w.length > 0);
                const count = words.length;

                if (count > 100) {
                    const trimmedText = words.slice(0, 100).join(' ');
                    bioArea.value = trimmedText;
                    wordHint.style.color = "#901e1e"; 
                    wordHint.innerText = '(Limit 100 slov dosiahnutý!)';
                } else {
                    wordHint.style.color = ''; 
                    wordHint.innerText = `(Zostáva slov: ${100 - count})`;
                }
            };
            bioArea.addEventListener('input', checkWords);
        }

        const checkbox = document.getElementById('show-password-reg');
        const pass1 = document.getElementById('id_password1');
        const pass2 = document.getElementById('id_password2');

        if (checkbox && pass1 && pass2) {
            checkbox.addEventListener('change', function() {
                const type = checkbox.checked ? 'text' : 'password';
                pass1.type = type;
                pass2.type = type;
            });
        }
    });
</script>
{% endblock %}
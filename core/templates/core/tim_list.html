<!DOCTYPE html>
<html>
<head>
    <title>Zoznam T√≠mov</title>
</head>
<body>
    {% include 'core/navbar.html' %}
    
    {% if user.is_authenticated %}
        {% with user_is_member_of_any_team=user.profil.tim_set.exists %}
            {% if not user_is_member_of_any_team %}
                <a href="{% url 'tim_create' %}" style="display: inline-block; margin-bottom: 20px; padding: 10px 15px; background-color: #28a745; color: white; text-decoration: none; border-radius: 5px;">
                    + Zalo≈æi≈• vlastn√Ω t√≠m
                </a>
                <hr>
            {% else %}
                 <p style="color: red; font-weight: bold;">Nem√¥≈æe≈° zalo≈æi≈• nov√Ω t√≠m, preto≈æe si u≈æ ƒçlenom in√©ho t√≠mu.</p>
                 <hr>
            {% endif %}
        {% endwith %}
    {% endif %}
    
    <h1>Hern√© T√≠my</h1>
    
    {% for tim in timy %}
        <div style="border: 1px solid #ccc; padding: 15px; margin-bottom: 20px;">
            <h2>{{ tim.nazov }}</h2>
            <p><strong>√örove≈à t√≠mu:</strong> {{ tim.uroven }}</p>
            <p>{{ tim.bio|default:"Bez popisu." }}</p>
            
            <p><strong>Poƒçet ƒçlenov:</strong> {{ tim.clenovia.count }}/5</p>
            
            <p style="font-size: 0.9em; color: gray;">
                ƒålenovia: 
                {% for clen in tim.clenovia.all %}
                    {{ clen.nickname }}{% if not forloop.last %}, {% endif %}
                {% endfor %}
            </p>

            {% if user.is_authenticated %}
                {% with user_is_member_of_any_team=user.profil.tim_set.exists %}
                    
                    {% if tim in user.profil.tim_set.all %}
                         <span style="color: green; font-weight: bold;">‚úî U≈æ si ƒçlenom tohto t√≠mu</span>
                    {% elif user_is_member_of_any_team %}
                         <span style="color: red; font-weight: bold;">‚ùå Si u≈æ v inom t√≠me.</span>
                    {% elif tim.clenovia.count >= 5 %}
                         <span style="color: red; font-weight: bold;">T√≠m je pln√Ω ({{ tim.clenovia.count }}/5)</span>
                    {% else %}
                         <a href="{% url 'tim_join' tim.id %}" style="color: blue; text-decoration: underline;">
                            üëâ Prida≈• sa do tohto t√≠mu
                        </a>
                    {% endif %}

                {% endwith %}
            {% endif %}
        </div>
    {% empty %}
        <p>Zatiaƒæ neboli zalo≈æen√© ≈æiadne t√≠my.</p>
    {% endfor %}
</body>
</html>